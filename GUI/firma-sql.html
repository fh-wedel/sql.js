<!doctype html>
<html>
<head>
	<meta charset="utf8">
  <title>
    firmal-sql.html
  </title>

<link rel="stylesheet" href="codemirror/lib/codemirror.css">
<script src="codemirror/lib/codemirror.js"></script>
	
<style>
.CodeMirror {
  top-margin: 10px;
  border: 1px solid #eee;
  height: auto;
}
.CodeMirror-scroll {
  overflow-y: hidden;
  overflow-x: auto;
}

.error {
	color:red;
	transition:.5s;
	overflow:hidden;
}

table {
	width:auto;
	border:1px solid black;
 	border-collapse:collapse;
 	margin-bottom:10px;
    background-color: #ddd;
    left:0px;
}
th, td {
	border:1px solid #777;
}
body {background-color:white}
header {background-color:#0D1E52; padding-top:10px}
#head1, #head2 {margin:25px; margin-top:10px; color: white}
#bar {height:15px; background-color:#7B7B7B}
#execute { background-color:#aaa; color:#fff; width:200px; border:6px solid #ddd; margin:10px}
#headlink { color:white; text-decoration: none}
#logo {   
	position: absolute;
    top: 0px;
    right: 0px;
}
#prompt {
   margin-top:30px;
   margin-bottom: 0px;
   font-weight: bold;
}
#result{
   font-weight: bold;	
}
</style>


</head>
<body>

<a href="http://www.fh-wedel.de"><img id="logo" src="http://www.fh-wedel.de/fileadmin/templates/relaunch/images/fh_logo.png" border="0"/></a>
<header>
	<h1 id="head1"><a id="headlink" href="http://www.fh-wedel.de/mitarbeiter/uh/lehrveranstaltungen/ws1314/datenbanken/">Einführung in Datenbanken</a></h1>
	<h2 id="head2">Online SQL-Interpretierer: Modelldatenbank FIRMA der Vorlesung</h2>
	<div id="bar"/>
</header>

	
<div id="init" style="display:none">
create table gehalt (
  geh_stufe varchar(4),
  betrag smallint not null,
  constraint Schluessel_Gehalt primary key (geh_stufe)
); 

create table abteilung (
  abt_nr char(3), 
  name char(20),
  constraint Schluessel_Abteilung primary key (abt_nr)
);

create table personal ( 
   pnr integer(4),
   name char(20) not null,
   vorname char(20),
   geh_stufe varchar(4),
   abt_nr char(3),
   krankenkasse char(3),
   constraint Schluessel_Personal primary key (pnr)
);

create table kind (
  pnr integer(4),
  k_name char(20) not null,
  k_vorname char(20),
  k_geb smallint
);

create table praemie (
  pnr integer(4),
  p_betrag smallint not null
);
   
create table maschine ( 
    mnr integer(4),
    name char(20) not null,
    pnr integer(4),
    ansch_datum date,
    neuwert integer,
    zeitwert integer,
    constraint Schluessel_Maschine primary key (mnr)
);

insert into gehalt (Geh_Stufe, Betrag) VALUES ('it1', 2523);
insert into gehalt (Geh_Stufe, Betrag) VALUES ('it2', 2873);
insert into gehalt (Geh_Stufe, Betrag) VALUES ('it3', 3027);
insert into gehalt (Geh_Stufe, Betrag) VALUES ('it4', 3341);
insert into gehalt (Geh_Stufe, Betrag) VALUES ('it5', 3782);

insert into abteilung (abt_nr, Name) VALUES ('d11', 'Verwaltung');
insert into abteilung (abt_nr, Name) VALUES ('d12', 'Projektierung');
insert into abteilung (abt_nr, Name) VALUES ('d13', 'Produktion');
insert into abteilung (abt_nr, Name) VALUES ('d14', 'Lagerung');
insert into abteilung (abt_nr, Name) VALUES ('d15', 'Verkauf');

insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (167, 'Krause', 'Gustav', 'it3', 'd12', 'dak');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (168, 'Hahn', 'Egon', 'it4', 'd11', 'bek');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (123, 'Lehmann', 'Karl', 'it3', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (133, 'Schulz', 'Harry', 'it1', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (124, 'Meier', 'Richard', 'it5', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (125, 'Wutschke', 'Oskar', 'it3', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (126, 'Schroeder', 'Karl-Heinz', 'it4', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (227, 'Wagner', 'Walter', 'it2', 'd13', 'dak');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (234, 'Krohn', 'August', 'it4', 'd13', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (135, 'Tietze', 'Lutz', 'it2', 'd13', 'tkk');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (156, 'Hartmann', 'Juergen', 'it1', 'd14', 'bek');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (127, 'Ehlert', 'Siegfried', 'it1', 'd15', 'kkh');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (157, 'Schultze', 'Hans', 'it1', 'd14', 'aok');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (159, 'Osswald', 'Petra', 'it2', 'd15', 'bak');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (137, 'Haase', 'Gert', 'it1', 'd11', 'kkh');
insert into personal (PNR, Name, Vorname, Geh_Stufe, Abt_Nr, Krankenkasse)
 VALUES  (134, 'Meier', 'Gerd', 'it5', 'd11', 'tkk');

insert into kind (pnr, k_name, k_vorname, k_geb)  VALUES (167, 'Krause', 'Fritz', 1997);
insert into kind (pnr, k_name, k_vorname, k_geb)  VALUES (167, 'Krause', 'Ida', 1999);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (123, 'Lehmann', 'Sven', 2002);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (123, 'Lehmann', 'Karl', 2004);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (168, 'Hahn', 'Hans', 1993);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (133, 'Wendler', 'Klaus', 1996);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (124, 'Meier', 'Gustav', 1999);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (124, 'Meier', 'Susi', 2002);
insert into kind (pnr, k_name, k_vorname, k_geb) VALUES (124, 'Meier', 'Dirk', 2004);

insert into praemie (PNR, P_Betrag) VALUES (227, 550);
insert into praemie (PNR, P_Betrag) VALUES (227, 610);
insert into praemie (PNR, P_Betrag) VALUES (227, 250);
insert into praemie (PNR, P_Betrag) VALUES (168, 600);
insert into praemie (PNR, P_Betrag) VALUES (168, 700);
insert into praemie (PNR, P_Betrag) VALUES (124, 250);
insert into praemie (PNR, P_Betrag) VALUES (234, 600);
insert into praemie (PNR, P_Betrag) VALUES (234, 500);
insert into praemie (PNR, P_Betrag) VALUES (127, 300);

insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (1, 'Bohrmaschine', 123, '1999-02-01', 30000, 15000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (2, 'Bohrmaschine', 123, '2002-07-01', 30000, 18000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (3, 'Fraesmaschine', 124,'1998-01-04', 40000, 10000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (11, 'Hobelmaschine', 127, '2002-01-15', 29000, 19000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (12, 'Drehbank', 126, '1999-08-01', 31000, 21000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (14, 'Hobelmaschine', 123, '1998-11-01', 32000, 22000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (16, 'Drehbank', 134, '2001-11-25', 32000, 23000);
insert into maschine (MNR, Name, PNR, Ansch_Datum, Neuwert, Zeitwert)
 VALUES (17, 'Bohrmaschine', 127, '2003-02-01', 31000, 25000);
</div>

<main>
    <div id="prompt">Bitte SQL-Abfragen eingeben:</div>
    <br>

    <textarea id="commands">
SELECT name FROM sqlite_master WHERE type='table';

select name, vorname, count(k_name) "Anzahl der Kinder" 
from personal left outer join kind using(pnr)
group by pnr, name, vorname
order by count(k_name) desc;

</textarea>
    <button id="execute">Ausführen</button>
<br>

<!--
<label>Load an SQLite database file: <input type='file' id='dbfile' ></label>
<button id='savedb'>Save the db</button>-->

	<div id="error" class="error"></div>
<div id="result">Abfrage-Ergebnis:</result>
  <pre id="output"></pre>
</main>

<script src="codemirror/mode/sql/sql.js"></script>

<footer style="display:none">
Original work by kripken (<a href='https://github.com/kripken/sql.js'>sql.js</a>).
C to Javascript compiler by kripken (<a href='https://github.com/kripken/emscripten'>emscripten</a>).
Fancy useless things by <a href='https://github.com/lovasoa'>lovasoa</a> (<a href='https://github.com/lovasoa/sql.js'>sql.js</a>).
</footer>


<script type="text/javascript" src="gui.js"></script>
</body>
</html>
